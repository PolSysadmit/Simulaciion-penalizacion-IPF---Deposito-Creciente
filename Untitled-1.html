<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>REINTEGRO DEPOSITO CRECIENTE 18M - Penalización por días transcurridos (Tarifas coyunturales)</title>
  <style>
    body {
      font-family: Verdana, Geneva, sans-serif;
      font-size: 12px;
    }

    button {
      background-color: #00594F;
      /* Green */
      border: none;
      color: white;

      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      margin: 4px 2px;
      transition-duration: 0.4s;
      cursor: pointer;
      height: 30px;
      width: 200px;
    }

    td label {
      display: inline-block;
      width: 180px;
      vertical-align: top;
    }

    .resultados td:first-child {
      font-weight: bold;
      text-align: left;
      padding-right: 5px;
    }

    .resultados td:last-child {
      text-align: left;
    }

    .total-row {
      /* background-color: rgb(227, 240, 216); */
      font-size: 14px;
      font-weight: bold;
      border-top: none;
      border-right: none;
      border-bottom: none;
      border-left: none;
      border: 1;
    }

    .total-row td {
      font-weight: bold;
      font-weight: bold;
      border-top: none;
      border-right: none;
      border-bottom: none;
      border-left: none;
      border: 1;
    }

    table {
      border-collapse: collapse;
    }

    tr.noBorder td {
      font-weight: bold;
      background-color: rgb(227, 240, 216);
      border-width: 0;
    }
  </style>
</head>

<body>
  <h1>REINTEGRO DEPOSITO CRECIENTE 18M - Penalización por días transcurridos (Tarifas coyunturales)</h1>
  <form id="calculadora">
    <table style="border: hidden">
      <tr>
        <td width="167">
          <label for="Importe">Importe (euros):</label>
        </td>
        <td><input type="number" id="Importe" name="Importe" value="100000"></td>
      </tr>
      <tr>
        <td>
          <label for="FechaInicio">Fecha inicio:</label>
        </td>
        <td><input type="date" id="FechaInicio" name="FechaInicio" value="2023-03-15"></td>
      </tr>
      <tr>
        <td>
          <label for="FechaVencimiento">Fecha vencimiento:</label>
        </td>
        <td><input type="date" id="FechaVencimiento" name="FechaVencimiento" value="2024-09-15"></td>
      </tr>
      <tr>
        <td><label for="PorcentajePenalizacion5"> % Penalización Reintegro:</label></td>
        <td><input type="number" id="PorcentajePenalizacion" name="PorcentajePenalizacion" value="2"></td>
        <td></td>
      </tr>
      <tr>
        <td><label for="PorcentajeRetencion">% Retención</label></td>
        <td><input type="number" id="PorcentajeRetencion" name="PorcentajeRetencion" value="19"></td>
      </tr>
      <tr>
        <td>1er SEMESTRE</td>
        <td></td>
      </tr>
      <tr>
        <td>Fecha liquidación</td>
        <td><input type="date" id="FechaLiquidacion1" name="FechaLiquidacion1" value="2023-09-15"></td>
      </tr>

      <tr>
        <td>
          <label for="TipoInteres1">% Tipo de interés:</label>
        </td>
        <td><input type="number" id="TipoInteres1" name="TipoInteres1" value="2.75"></td>
      </tr>
      <tr id="ImporteReintegroContainer1">
        <td><label for="ImporteReintegro1">Importe reintegro (euros):</label></td>
        <td><input type="number" id="ImporteReintegro1" name="ImporteReintegro1" value="500"></td>
      </tr>
      <tr>
        <td><label for="FechaReintegro3">Fecha reintegro:</label></td>
        <td><input type="date" id="FechaReintegro1" name="FechaReintegro1" value="2023-05-15"></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>2º SEMESTRE</td>
        <td></td>
      </tr>
      <tr>
        <td>Fecha liquidación</td>
        <td><input type="date" id="FechaLiquidacion2" name="FechaLiquidacion2" value="2024-03-15"></td>
      </tr>
      <tr>
        <td><label for="TipoInteres1">% Tipo de interés:</label></td>
        <td><input type="number" id="TipoInteres2" name="TipoInteres2" value="3"></td>
      </tr>
      <tr id="ImporteReintegroContainer2">
        <td><label for="ImporteReintegro2">Importe reintegro (euros):</label></td>
        <td><input type="number" id="ImporteReintegro2" name="ImporteReintegro2" value="700"></td>
      </tr>
      <tr>
        <td><label for="FechaReintegro4">Fecha reintegro:</label></td>
        <td><input type="date" id="FechaReintegro2" name="FechaReintegro2" value="2023-10-15"></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>3er SEMESTRE</td>
        <td></td>
      </tr>
      <tr>
        <td>Fecha liquidación</td>
        <td><input type="date" id="FechaLiquidacion3" name="FechaLiquidacion3" value="2024-09-15"></td>
      </tr>
      <tr>
        <td><label for="TipoInteres3">% Tipo de interés:</label></td>
        <td><input type="number" id="TipoInteres3" name="TipoInteres3" value="3.75"></td>
      </tr>
      <tr id="ImporteReintegroContainer3">
        <td><label for="ImporteReintegro3">Importe reintegro (euros):</label></td>
        <td><input type="number" id="ImporteReintegro3" name="ImporteReintegro3" value="800"></td>
      </tr>
      <tr>
        <td><label for="FechaReintegro3">Fecha reintegro:</label></td>
        <td><input type="date" id="FechaReintegro3" name="FechaReintegro3" value="2024-04-15"></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
      </tr>

      <tr>
        <td>
          <br>
          <center><button type="button" onclick="calcularLiquidacion()">Calcular Liquidación</button></center>
        </td>
      </tr>
    </table>
  </form>


  <p>&nbsp;</p>

  <!-- <div id="resultados" style="display: none;"> -->
  <div id="resultados">
    <h2>Resultados</h2>
    <table class="resultados">
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>LIQUIDACIÓN PRIMER SEMESTRE</td>
        <td></td>
        <td></td>
        <td>LIQUIDACIÓN SEGUNDO SEMESTRE</td>
        <td></td>
        <td></td>
        <td>LIQUIDACIÓN TERCER SEMESTRE</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>Importe vivo</td>
        <td id="ImporteVivoL1"></td>
        <td></td>
        <td>Importe vivo</td>
        <td id="ImporteVivoL2"></td>
        <td></td>
        <td>Importe vivo</td>
        <td id="ImporteVivoL3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Fecha liquidación</td>
        <td id="FechaLiquidacionL1"></td>
        <td></td>
        <td>Fecha liquidación</td>
        <td id="FechaLiquidacionL2"></td>
        <td></td>
        <td>Fecha liquidación</td>
        <td id="FechaLiquidacionL3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Días transcurridos</td>
        <td id="DiasTranscurridosL1"></td>
        <td></td>
        <td>Días transcurridos</td>
        <td id="DiasTranscurridosL2"></td>
        <td></td>
        <td>Días transcurridos</td>
        <td id="DiasTranscurridosL3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Tipo de interés</td>
        <td id="PorcentajeTipoInteresL1"></td>
        <td></td>
        <td>Tipo de interés</td>
        <td id="PorcentajeTipoInteresL2"></td>
        <td></td>
        <td>Tipo de interés</td>
        <td id="PorcentajeTipoInteresL3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Intereses Euros</td>
        <td id="InteresesEurosL1"></td>
        <td></td>
        <td>Intereses Euros</td>
        <td id="InteresesEurosL2"></td>
        <td></td>
        <td>Intereses Euros</td>
        <td id="InteresesEurosL3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>% Retención </td>
        <td id="PorcentajeRetencionL1"></td>
        <td></td>
        <td>% Retención </td>
        <td id="PorcentajeRetencionL2"></td>
        <td></td>
        <td>% Retención </td>
        <td id="PorcentajeRetencionL3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Retención Euros</td>
        <td id="RetencionEurosL1"></td>
        <td></td>
        <td>Retención Euros</td>
        <td id="RetencionEurosL2"></td>
        <td></td>
        <td>Retención Euros</td>
        <td id="RetencionEurosL3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td id="SimulacionLiquidacionL1">Simulación liquidación</td>
        <td></td>
        <td></td>
        <td id="SimulacionLiquidacionL2">Simulación liquidación</td>
        <td></td>
        <td></td>
        <td id="SimulacionLiquidacionL3">Simulación liquidación</td>
        <td></td>
        <td></td>
      </tr>

      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td> +Intereses</td>
        <td id="MasInteresesL1"></td>
        <td></td>
        <td> +Intereses</td>
        <td id="MasInteresesL2"></td>
        <td></td>
        <td> +Intereses</td>
        <td id="MasInteresesL3"></td>
        <td></td>
      </tr>
      <tr>
        <td> -Retención</td>
        <td id="MenosRetencionL1"></td>
        <td></td>
        <td> -Retención</td>
        <td id="MenosRetencionL2"></td>
        <td></td>
        <td> -Retención</td>
        <td id="MenosRetencionL3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td id="ResultadoL1"></td>
        <td></td>
        <td></td>
        <td id="ResultadoL2"></td>
        <td></td>
        <td></td>
        <td id="ResultadoL3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td>
        </td>
        <td>
        </td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>REINTEGRO PRIMER SEMESTRE</td>
        <td></td>
        <td></td>
        <td>REINTEGRO SEGUNDO SEMESTRE</td>
        <td></td>
        <td></td>
        <td>REINTEGRO TERCER SEMESTRE</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>Importe Reintegro</td>
        <td id="ImporteReintegroR1"></td>
        <td></td>
        <td>Importe Reintegro</td>
        <td id="ImporteReintegroR2"></td>
        <td></td>
        <td>Importe Reintegro</td>
        <td id="ImporteReintegroR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Fecha reintegro</td>
        <td id="FechaReintegroR1"></td>
        <td></td>
        <td>Fecha reintegro</td>
        <td id="FechaReintegroR2"></td>
        <td></td>
        <td>Fecha reintegro</td>
        <td id="FechaReintegroR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>% Penalización</td>
        <td id="PorcentajePenalizacionR1"></td>
        <td></td>
        <td>% Penalización</td>
        <td id="PorcentajePenalizacionR2"></td>
        <td></td>
        <td>% Penalización</td>
        <td id="PorcentajePenalizacionR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Días transcurridos desde inicio</td>
        <td id="DiasTranscurridosR1"></td>
        <td></td>
        <td>Días transcurridos</td>
        <td id="DiasTranscurridosR2"></td>
        <td></td>
        <td>Días transcurridos</td>
        <td id="DiasTranscurridosR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Días transcurridos desde anterior liquidación</td>
        <td id="DiasTranscurridosDesdeAnteriorLiquidacionR1"></td>
        <td></td>
        <td>Días transcurridos desde anterior liquidación</td>
        <td id="DiasTranscurridosDesdeAnteriorLiquidacionR2"></td>
        <td></td>
        <td>Días transcurridos desde anterior liquidación</td>
        <td id="DiasTranscurridosDesdeAnteriorLiquidacionR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Intereses reintegro</td>
        <td id="InteresesReintegorR1"></td>
        <td></td>
        <td>Intereses reintegro</td>
        <td id="InteresesReintegorR2"></td>
        <td></td>
        <td>Intereses reintegro</td>
        <td id="InteresesReintegorR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Penalización Euros</td>
        <td id="PenalizacionEurosR1"></td>
        <td></td>
        <td>Penalización Euros</td>
        <td id="PenalizacionEurosR2"></td>
        <td></td>
        <td>Penalización Euros</td>
        <td id="PenalizacionEurosR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Máximo intereses brutos</td>
        <td id="MaximoInteresesBrutosR1"></td>
        <td></td>
        <td>Máximo intereses brutos</td>
        <td id="MaximoInteresesBrutosR2"></td>
        <td></td>
        <td>Máximo intereses brutos</td>
        <td id="MaximoInteresesBrutosR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Penalización a aplicar</td>
        <td id="PenalizacionAplicarR1"></td>
        <td></td>
        <td>Penalización a aplicar</td>
        <td id="penalizacionAplicarR2"></td>
        <td></td>
        <td>Penalización a aplicar</td>
        <td id="penalizacionAplicarR3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>% Retención </td>
        <td id="PorcentajeRetencionR1"></td>
        <td></td>
        <td>% Retención </td>
        <td id="PorcentajeRetencionR2"></td>
        <td></td>
        <td>% Retención </td>
        <td id="PorcentajeRetencionR3"></td>
        <td></td>
      </tr>
      <tr>
        <td>Retención Euros</td>
        <td id="RetencionEurosR1"></td>
        <td></td>
        <td>Retención Euros</td>
        <td id="RetencionEurosR2"></td>
        <td></td>
        <td>Retención Euros</td>
        <td id="RetencionEurosR3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>Simulación reintegro</td>
        <td></td>
        <td></td>
        <td>Simulación reintegro</td>
        <td></td>
        <td></td>
        <td>Simulación reintegro</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td> +Capital</td>
        <td id="MasCapitalR1"></td>
        <td></td>
        <td> +Capital</td>
        <td id="MasCapitalR2"></td>
        <td></td>
        <td> +Capital</td>
        <td id="MasCapitalR3"></td>
        <td></td>
      </tr>
      <tr>
        <td> +Intereses</td>
        <td id="MasInteresesR1"></td>
        <td></td>
        <td> +Intereses</td>
        <td id="MasInteresesR2"></td>
        <td></td>
        <td> +Intereses</td>
        <td id="MasInteresesR3"></td>
        <td></td>
      </tr>
      <tr>
        <td> -Retención</td>
        <td id="MenosRetencionR1"></td>
        <td></td>
        <td> -Retención</td>
        <td id="MenosRetencionR2"></td>
        <td></td>
        <td> -Retención</td>
        <td id="MenosRetencionR3"></td>
        <td></td>
      </tr>
      <tr>
        <td> -Penalización</td>
        <td id="MenosPenalicacionR1"></td>
        <td></td>
        <td> -Penalización</td>
        <td id="MenosPenalicacionR2"></td>
        <td></td>
        <td> -Penalización</td>
        <td id="MenosPenalicacionR3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td id="ResultadoR1"></td>
        <td></td>
        <td></td>
        <td id="ResultadoR2"></td>
        <td></td>
        <td></td>
        <td id="ResultadoR3"></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
    </table>
  </div>
</body>
<script>
  // Crea una función para mostrar los resultados
  function showResults() {

    const resultadosDiv = document.getElementById("resultados");
    resultadosDiv.style.display = "block";

  }

  function calcularDuracion(FechaInicio, fechaFin) {
    const MS_PER_DAY = 1000 * 60 * 60 * 24;
    const DIAS_EN_UN_MES = 30.44;
    const duracionMeses = (fechaFin - FechaInicio) / (MS_PER_DAY * DIAS_EN_UN_MES);
    const duracionDias = Math.round((fechaFin - FechaInicio) / MS_PER_DAY);

    return {
      duracionMeses,
      duracionDias
    };
  }


  function formatearNumero(numero) {
    return numero.toLocaleString("es-ES", {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2,
      useGrouping: true,
    });
  }

  function formatearFecha(fecha) {
    return fecha.toLocaleDateString("es-ES");
  }

  function rellenarCampos(obj) {
    for (var key in obj) {
      if (obj.hasOwnProperty(key)) {
        var elem = document.getElementById(key);
        if (elem) {
          if (obj[key] instanceof Date) {
            elem.innerText = formatearFecha(obj[key]);
          } else {
            elem.innerText = formatearNumero(obj[key]);
          }
        }
      }
    }
  }

  function roundHalfToEven(value, precision) {
    const scale = Math.pow(10, precision);
    const rounded = Math.round(value * scale);
    const adjustment = (rounded % 2 === 1 && value * scale % 1 === 0.5) ? -1 : 0;
    return (rounded + adjustment) / scale;
  }



  function calcularLiquidacion() {

    // Obtén los valores de los elementos de entrada
    const Importe = parseFloat(document.getElementById("Importe").value);
    const FechaInicio = new Date(document.getElementById("FechaInicio").value);
    const FechaVencimiento = new Date(document.getElementById("FechaVencimiento").value);
    const PorcentajePenalizacion = parseFloat(document.getElementById("PorcentajePenalizacion").value) / 100;
    const PorcentajeRetencion = parseFloat(document.getElementById("PorcentajeRetencion").value) / 100;

    const FechaLiquidacion1 = new Date(document.getElementById("FechaLiquidacion1").value);
    const FechaLiquidacion2 = new Date(document.getElementById("FechaLiquidacion2").value);
    const FechaLiquidacion3 = new Date(document.getElementById("FechaLiquidacion3").value);

    const PorcentajeTipoInteres1 = parseFloat(document.getElementById("TipoInteres1").value) / 100;
    const PorcentajeTipoInteres2 = parseFloat(document.getElementById("TipoInteres2").value) / 100;
    const PorcentajeTipoInteres3 = parseFloat(document.getElementById("TipoInteres3").value) / 100;

    const ImporteReintegro1 = parseFloat(document.getElementById("ImporteReintegro1").value);
    const ImporteReintegro2 = parseFloat(document.getElementById("ImporteReintegro2").value);
    const ImporteReintegro3 = parseFloat(document.getElementById("ImporteReintegro3").value);

    const FechaReintegro1 = new Date(document.getElementById("FechaReintegro1").value);
    const FechaReintegro2 = new Date(document.getElementById("FechaReintegro2").value);
    const FechaReintegro3 = new Date(document.getElementById("FechaReintegro3").value);


    const FechaLiquidacionL1 = FechaLiquidacion1;
    const FechaLiquidacionL2 = FechaLiquidacion2;
    const FechaLiquidacionL3 = FechaLiquidacion3;

    const FechaReintegroR1 = FechaReintegro1;
    const FechaReintegroR2 = FechaReintegro2;
    const FechaReintegroR3 = FechaReintegro3;

    const PorcentajeTipoInteresL1 = PorcentajeTipoInteres1 * 100;
    const PorcentajeTipoInteresL2 = PorcentajeTipoInteres2 * 100;
    const PorcentajeTipoInteresL3 = PorcentajeTipoInteres3 * 100;

    const PorcentajeRetencionL1 = PorcentajeRetencion * 100;
    const PorcentajeRetencionL2 = PorcentajeRetencion * 100;
    const PorcentajeRetencionL3 = PorcentajeRetencion * 100;

    const PorcentajeRetencionR1 = PorcentajeRetencion * 100;
    const PorcentajeRetencionR2 = PorcentajeRetencion * 100;
    const PorcentajeRetencionR3 = PorcentajeRetencion * 100;


    const ImporteReintegroR1 = ImporteReintegro1;
    const ImporteReintegroR2 = ImporteReintegro2;
    const ImporteReintegroR3 = ImporteReintegro3;

    const PorcentajePenalizacionR1 = PorcentajePenalizacion * 100;
    const PorcentajePenalizacionR2 = PorcentajePenalizacion * 100;
    const PorcentajePenalizacionR3 = PorcentajePenalizacion * 100;

    //Calcular Liquidaciones

    const ImporteVivoL1 = Importe - ImporteReintegroR1;
    const ImporteVivoL2 = ImporteVivoL1 - ImporteReintegroR2;
    const ImporteVivoL3 = ImporteVivoL2 - ImporteReintegroR3;

    const DiasTranscurridosL1 = Math.abs(calcularDuracion(FechaInicio, FechaLiquidacionL1).duracionDias);
    const DiasTranscurridosL2 = Math.abs(calcularDuracion(FechaLiquidacionL1, FechaLiquidacionL2).duracionDias);
    const DiasTranscurridosL3 = Math.abs(calcularDuracion(FechaLiquidacionL2, FechaLiquidacionL3).duracionDias);

    const InteresesEurosL1 = ImporteVivoL1 * PorcentajeTipoInteres1 * DiasTranscurridosL1 / 365;
    const InteresesEurosL2 = ImporteVivoL2 * PorcentajeTipoInteres2 * DiasTranscurridosL2 / 365;
    const InteresesEurosL3 = ImporteVivoL3 * PorcentajeTipoInteres3 * DiasTranscurridosL3 / 365;

    const RetencionEurosL1 = InteresesEurosL1 * PorcentajeRetencion;
    const RetencionEurosL2 = InteresesEurosL2 * PorcentajeRetencion;
    const RetencionEurosL3 = InteresesEurosL3 * PorcentajeRetencion;

    const MasInteresesL1 = Math.abs(InteresesEurosL1);
    const MasInteresesL2 = Math.abs(InteresesEurosL2);
    const MasInteresesL3 = Math.abs(InteresesEurosL3);

    const MenosRetencionL1 = RetencionEurosL1 * -1;
    const MenosRetencionL2 = RetencionEurosL2 * -1;
    const MenosRetencionL3 = RetencionEurosL3 * -1;

    const ResultadoL1 = Math.abs(MasInteresesL1 + MenosRetencionL1);
    const ResultadoL2 = Math.abs(MasInteresesL2 + MenosRetencionL2);
    const ResultadoL3 = Math.abs(MasInteresesL3 + MenosRetencionL3);

    //Calcular Reintegros

    const DiasTranscurridosR1 = Math.abs(calcularDuracion(FechaInicio, FechaReintegroR1).duracionDias);
    const DiasTranscurridosR2 = Math.abs(calcularDuracion(FechaInicio, FechaReintegroR2).duracionDias);
    const DiasTranscurridosR3 = Math.abs(calcularDuracion(FechaInicio, FechaReintegroR3).duracionDias);

    const DiasTranscurridosDesdeAnteriorLiquidacionR1 = Math.abs(DiasTranscurridosR1);
    const DiasTranscurridosDesdeAnteriorLiquidacionR2 = Math.abs(calcularDuracion(FechaReintegroR2, FechaLiquidacionL1).duracionDias);
    const DiasTranscurridosDesdeAnteriorLiquidacionR3 = Math.abs(calcularDuracion(FechaReintegroR3, FechaLiquidacionL2).duracionDias);

    const InteresesReintegorR1 = Math.abs(ImporteReintegroR1) * PorcentajeTipoInteres1 * DiasTranscurridosR1 / 365;
    const InteresesReintegorR2 = Math.abs(ImporteReintegroR2) * PorcentajeTipoInteres2 * DiasTranscurridosDesdeAnteriorLiquidacionR2 / 365;
    const InteresesReintegorR3 = Math.abs(ImporteReintegroR3) * PorcentajeTipoInteres3 * DiasTranscurridosDesdeAnteriorLiquidacionR3 / 365;

    const PenalizacionEurosR1 = Math.abs(ImporteReintegroR1) * PorcentajePenalizacion * DiasTranscurridosR1 / 365;
    const PenalizacionEurosR2 = Math.abs(ImporteReintegroR2) * PorcentajePenalizacion * DiasTranscurridosR2 / 365;
    const PenalizacionEurosR3 = Math.abs(ImporteReintegroR3) * PorcentajePenalizacion * DiasTranscurridosR3 / 365;

    const RetencionEurosR1 = Math.abs(InteresesReintegorR1) * PorcentajeRetencion;
    const RetencionEurosR2 = Math.abs(InteresesReintegorR2) * PorcentajeRetencion;
    const RetencionEurosR3 = Math.abs(InteresesReintegorR3) * PorcentajeRetencion;

    const MasCapitalR1 = Math.abs(ImporteReintegroR1);
    const MasCapitalR2 = Math.abs(ImporteReintegroR2);
    const MasCapitalR3 = Math.abs(ImporteReintegroR3);

    const MasInteresesR1 = Math.abs(InteresesReintegorR1);
    const MasInteresesR2 = Math.abs(InteresesReintegorR2);
    const MasInteresesR3 = Math.abs(InteresesReintegorR3);

    const MenosRetencionR1 = RetencionEurosR1 * -1;
    const MenosRetencionR2 = RetencionEurosR2 * -1;
    const MenosRetencionR3 = RetencionEurosR3 * -1;

    const MaximoInteresesBrutosR1 = Math.abs(Importe) * PorcentajeTipoInteres1 * DiasTranscurridosR1 / 365;
    const MaximoInteresesBrutosR2 = MasInteresesL1 + MasInteresesR1 + InteresesEurosL2 + InteresesReintegorR2;

    const MaximoInteresesBrutosR3 = MasInteresesL1 + MasInteresesR1 + InteresesEurosL2 + MasInteresesR2 + InteresesEurosL3 + InteresesReintegorR3;
    //const MaximoInteresesBrutosR3 = Math.abs(MasInteresesR1) + InteresesEurosL1 + InteresesReintegorR1 + InteresesEurosL2 + InteresesEurosL3 + InteresesReintegorR3;

    let PenalizacionAplicarR1 = (PenalizacionEurosR1 > MaximoInteresesBrutosR1) ? MaximoInteresesBrutosR1 : PenalizacionEurosR1;
    let PenalizacionAplicarR2 = (PenalizacionEurosR2 > MaximoInteresesBrutosR2) ? MaximoInteresesBrutosR2 : PenalizacionEurosR2;
    let PenalizacionAplicarR3 = (PenalizacionEurosR3 > MaximoInteresesBrutosR3) ? MaximoInteresesBrutosR3 : PenalizacionEurosR3;

    const MenosPenalicacionR1 = PenalizacionAplicarR1 * -1;
    const MenosPenalicacionR2 = PenalizacionAplicarR2 * -1;
    const MenosPenalicacionR3 = PenalizacionAplicarR3 * -1;


    const ResultadoR1 = MasCapitalR1 + MasInteresesR1 + MenosRetencionR1 + MenosPenalicacionR1;
    const ResultadoR2 = MasCapitalR2 + MasInteresesR2 + MenosRetencionR2 + MenosPenalicacionR2;
    const ResultadoR3 = MasCapitalR3 + MasInteresesR3 + MenosRetencionR3 + MenosPenalicacionR3;

    var Campos = {
      ImporteVivoL1: ImporteVivoL1,
      ImporteVivoL2: ImporteVivoL2,
      ImporteVivoL3: ImporteVivoL3,
      PorcentajeTipoInteresL1: PorcentajeTipoInteresL1,
      PorcentajeTipoInteresL2: PorcentajeTipoInteresL2,
      PorcentajeTipoInteresL3: PorcentajeTipoInteresL3,
      PorcentajeRetencionL1: PorcentajeRetencionL1,
      PorcentajeRetencionL2: PorcentajeRetencionL2,
      PorcentajeRetencionL3: PorcentajeRetencionL3,
      ImporteReintegroR1: ImporteReintegroR1,
      ImporteReintegroR2: ImporteReintegroR2,
      ImporteReintegroR3: ImporteReintegroR3,
      PorcentajePenalizacionR1: PorcentajePenalizacionR1,
      PorcentajePenalizacionR2: PorcentajePenalizacionR2,
      PorcentajePenalizacionR3: PorcentajePenalizacionR3,
      DiasTranscurridosL1: DiasTranscurridosL1,
      DiasTranscurridosL2: DiasTranscurridosL2,
      DiasTranscurridosL3: DiasTranscurridosL3,
      InteresesEurosL1: InteresesEurosL1,
      InteresesEurosL2: InteresesEurosL2,
      InteresesEurosL3: InteresesEurosL3,
      FechaLiquidacionL1: FechaLiquidacionL1,
      FechaLiquidacionL2: FechaLiquidacionL2,
      FechaLiquidacionL3: FechaLiquidacionL3,
      FechaReintegroR1: FechaReintegroR1,
      FechaReintegroR2: FechaReintegroR2,
      FechaReintegroR3: FechaReintegroR3,
      RetencionEurosL1: RetencionEurosL1,
      RetencionEurosL2: RetencionEurosL2,
      RetencionEurosL3: RetencionEurosL3,
      MasInteresesL1: MasInteresesL1,
      MasInteresesL2: MasInteresesL2,
      MasInteresesL3: MasInteresesL3,
      MenosRetencionL1: MenosRetencionL1,
      MenosRetencionL2: MenosRetencionL2,
      MenosRetencionL3: MenosRetencionL3,
      ResultadoL1: ResultadoL1,
      ResultadoL2: ResultadoL2,
      ResultadoL3: ResultadoL3,
      DiasTranscurridosR1: DiasTranscurridosR1,
      DiasTranscurridosR2: DiasTranscurridosR2,
      DiasTranscurridosR3: DiasTranscurridosR3,
      DiasTranscurridosDesdeAnteriorLiquidacionR1: DiasTranscurridosDesdeAnteriorLiquidacionR1,
      DiasTranscurridosDesdeAnteriorLiquidacionR2: DiasTranscurridosDesdeAnteriorLiquidacionR2,
      DiasTranscurridosDesdeAnteriorLiquidacionR3: DiasTranscurridosDesdeAnteriorLiquidacionR3,
      InteresesReintegorR1: InteresesReintegorR1,
      InteresesReintegorR2: InteresesReintegorR2,
      InteresesReintegorR3: InteresesReintegorR3,
      PenalizacionEurosR1: PenalizacionEurosR1,
      PenalizacionEurosR2: PenalizacionEurosR2,
      PenalizacionEurosR3: PenalizacionEurosR3,
      MaximoInteresesBrutosR1: MaximoInteresesBrutosR1,
      MaximoInteresesBrutosR2: MaximoInteresesBrutosR2,
      MaximoInteresesBrutosR3: MaximoInteresesBrutosR3,
      PenalizacionAplicarR1: PenalizacionAplicarR1,
      PorcentajeRetencionR1: PorcentajeRetencionR1,
      PorcentajeRetencionR2: PorcentajeRetencionR2,
      PorcentajeRetencionR3: PorcentajeRetencionR3,
      RetencionEurosR1: RetencionEurosR1,
      RetencionEurosR2: RetencionEurosR2,
      RetencionEurosR3: RetencionEurosR3,
      MasCapitalR1: MasCapitalR1,
      MasCapitalR2: MasCapitalR2,
      MasCapitalR3: MasCapitalR3,
      MasInteresesR1: MasInteresesR1,
      MasInteresesR2: MasInteresesR2,
      MasInteresesR3: MasInteresesR3,
      MenosRetencionR1: MenosRetencionR1,
      MenosRetencionR2: MenosRetencionR2,
      MenosRetencionR3: MenosRetencionR3,
      MenosPenalicacionR1: MenosPenalicacionR1,
      MenosPenalicacionR2: MenosPenalicacionR2,
      MenosPenalicacionR3: MenosPenalicacionR3,
      ResultadoR1: ResultadoR1,
      ResultadoR2: ResultadoR2,
      ResultadoR3: ResultadoR3



    }

    //rellenarCamposFecha(CamposFecha);

    rellenarCampos(Campos);



    // document.getElementById("MaximoInteresesBrutosR1").innerText = formatearNumero(MaximoInteresesBrutosR1);
    // document.getElementById("MaximoInteresesBrutosR2").innerText = MaximoInteresesBrutosR2;
    // document.getElementById("MaximoInteresesBrutosR3").innerText = MaximoInteresesBrutosR3;



    showResults();


    // // Validar los campos
    // if (!validarCampos()) {
    //   return;
    // }

    // // Calcula duraciones en meses y días
    // const duraciones = calcularDuracion(FechaInicio, FechaVencimiento, FechaReintegro);
    // const duracionMeses = duraciones.duracionMeses;
    // const diasTranscurridos = duraciones.diasTranscurridos;
    // const diasRemanentes = duraciones.diasRemanentes;

    // // Calcula los intereses devengados y los intereses a reintegrar en euros
    // const InteresesEurosDevengados = Importe * TipoInteres * diasTranscurridos / 365;
    // const InteresesEurosReintegro = ImporteReintegro * TipoInteres * diasTranscurridos / 365;

    // // Establece valores iniciales para los intereses, la retención y la penalización
    // let InteresesEuros = InteresesEurosReintegro;
    // let retencionEuros = InteresesEurosReintegro * PorcentajeRetencion;
    // let MaximoInteresesBrutos = InteresesEurosDevengados;

    // // Actualiza los valores de intereses y retención si el reintegro es total
    // if (reintegro === 'Total') {
    //   InteresesEuros = InteresesEurosDevengados;
    //   retencionEuros = InteresesEuros * PorcentajeRetencion;
    // }

    // // Calcula las penalizaciones en euros según el tipo de tarifa
    // const PenalizacionEuros = ImporteReintegro * (
    //   tipoTarifa === 'Coyuntural'
    //     ? diasTranscurridos
    //     : diasRemanentes
    // ) * PorcentajePenalizacion / 365;

    // // Selecciona la penalización a aplicar (la menor entre la penalización y los intereses brutos)
    // const penalizacionAplicar = Math.min(PenalizacionEuros, MaximoInteresesBrutos);

    // // Calcula el capital, la retención, la penalización y el total a pagar
    // const capital = ImporteReintegro;
    // const retencion = -retencionEuros;
    // const penalizacion = -penalizacionAplicar;
    // const total = capital + InteresesEuros + retencion + penalizacion;


    // Muestra los resultados en los elementos HTML correspondientes
    //document.getElementById("ImporteVivoL1").innerText = formatearNumero(ImporteVivoL1);
    // document.getElementById("diasTranscurridos").innerText = formatearNumero(diasTranscurridos);
    // document.getElementById("diasRemanentes").innerText = formatearNumero(diasRemanentes);
    // document.getElementById("InteresesEuros").innerText = formatearNumero(InteresesEuros) + " euros";
    // document.getElementById("InteresesEurosReintegro").innerText = formatearNumero(InteresesEurosReintegro) + " euros";
    // document.getElementById("InteresesEurosDevengados").innerText = formatearNumero(InteresesEurosDevengados) + " euros";
    // document.getElementById("retencionEuros").innerText = formatearNumero(retencionEuros) + " euros";
    // document.getElementById("PenalizacionEuros").innerText = formatearNumero(PenalizacionEuros) + " euros";
    // document.getElementById("MaximoInteresesBrutos").innerText = formatearNumero(MaximoInteresesBrutos) + " euros";
    // document.getElementById("penalizacionAplicar").innerText = formatearNumero(penalizacionAplicar) + " euros";
    // document.getElementById("capital").innerText = formatearNumero(capital) + " euros";
    // document.getElementById("intereses").innerText = formatearNumero(InteresesEuros) + " euros";
    // document.getElementById("retencion").innerText = formatearNumero(retencion) + " euros";
    // document.getElementById("penalizacion").innerText = formatearNumero(penalizacion) + " euros";
    // document.getElementById("total").innerText = formatearNumero(total) + " euros";


  }



</script>



</html>